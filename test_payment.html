<!DOCTYPE html>
<html>
<head>
    <title>Test Payment</title>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
</head>
<body>

<button id="pay-btn">Pay Now</button>

<script>
document.getElementById("pay-btn").onclick = async function () {

    // STEP 1: Create Order from your backend
    const response = await fetch("https://subscription-bot-278g.onrender.com/payment/create-order?plan_id=699fe8d0a3174f92c5146355&user_id=12345678", {
        method: "POST"
    });

    const data = await response.json();

    const options = {
        "key": data.key_id,
        "amount": data.amount,
        "currency": "INR",
        "name": "Your Platform Name",
        "description": "Subscription Payment",
        "order_id": data.order_id,

        "handler": async function (response) {

            console.log("Razorpay Response:", response);

            const verifyResponse = await fetch("https://subscription-bot-278g.onrender.com/payment/verify", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    razorpay_order_id: response.razorpay_order_id,
                    razorpay_payment_id: response.razorpay_payment_id,
                    razorpay_signature: response.razorpay_signature
                })
            });

            const result = await verifyResponse.json();
            console.log("Verify Result:", result);

            alert("Payment Verified & Subscription Activated");
        },

        "theme": {
            "color": "#3399cc"
        }
    };

    const rzp = new Razorpay(options);
    rzp.open();
};
</script>

</body>
</html>